import {useEffect, useState} from 'react'
import {
  Button,
  CardBody,
  Modal,
  ModalBody,
  ModalFooter,
  ModalHeader,
  Nav,
  NavItem,
  NavLink,
  TabContent,
  TabPane,
} from 'reactstrap'
import {useHistory, useLocation} from 'react-router-dom'

// *** Custom Components
import {
  ExploitedGroupPage,
  ExploitedPostPage,
  ExploitedFanpage,
  ExploitedProfile,
  Breadcrumb,
  PostSetting,
  GroupSetting,
  ProfileSetting,
  FanpageSetting,
  ExploidtedKeyWords,
} from '@services/exploite-customer-leads'
import KeywordsSetting from '../../components/tabs/KeyWords/KeywordsSetting'

// ** assets
import './Customer.style.scss'
import {Settings} from 'react-feather'

const IndexExploited = () => {
  const [active, setActive] = useState('1')
  const history = useHistory()
  const location = useLocation()

  const routers = [
    {id: '1', path: '', name: 'Khai thác nhóm'},
    {id: '2', path: '/exploit-post', name: 'Khai thác post'},
    {id: '3', path: '/exploit-fanpage', name: 'Khai thác Fanpage'},
    {id: '4', path: '/exploit-personal', name: 'Khai thác trang cá nhân'},
    // {id: '5', path: '/schadule-post', name: 'Lịch Post'},
    {id: '5', path: '/exploit-keywords', name: 'Khai thác từ khóa'},
  ]

  useEffect(() => {
    if (location) {
      routers.map(
        item => location.pathname?.includes(item.path) && setActive(item.id),
      )
    }
  }, [location])

  const toggle = tab => {
    if (active !== tab) {
      setActive(tab)
    }
  }

  const [modal, setModal] = useState(false)

  const [tabVertical, setTabVertical] = useState('1')

  const handClick = tab => {
    if (tabVertical !== tab) {
      setTabVertical(tab)
    }
  }

  return (
    <div style={{backgroundColor: '#fff'}}>
      <div className="d-flex justify-content-between">
        <Breadcrumb routers={routers} active={active} />
        <div className="mt-2 mr-2">
          <Button.Ripple outline color="primary" onClick={() => setModal(true)}>
            <Settings size={14} className="mr-1" />
            <span className="align-middle ms-25">Cài đặt chung</span>
          </Button.Ripple>
        </div>
        <Modal
          isOpen={modal === true}
          className={'modal-dialog-centered modal-xl'}
        >
          <ModalHeader>
            <Settings size={16} className="mr-2" />
            <span className="align-middle ms-25">Cài đặt chung</span>
          </ModalHeader>
          <ModalBody>
            <div className="nav-vertical">
              <Nav tabs className="nav-left">
                <NavItem>
                  <NavLink
                    active={tabVertical === '1'}
                    onClick={() => handClick('1')}
                  >
                    List Group
                  </NavLink>
                </NavItem>
                <NavItem>
                  <NavLink
                    active={tabVertical === '2'}
                    onClick={() => handClick('2')}
                  >
                    List Post
                  </NavLink>
                </NavItem>
                <NavItem>
                  <NavLink
                    active={tabVertical === '3'}
                    onClick={() => handClick('3')}
                  >
                    List Profile
                  </NavLink>
                </NavItem>
                <NavItem>
                  <NavLink
                    active={tabVertical === '4'}
                    onClick={() => handClick('4')}
                  >
                    List Fanpage
                  </NavLink>
                </NavItem>
                <NavItem>
                  <NavLink
                    active={tabVertical === '5'}
                    onClick={() => handClick('5')}
                  >
                    Từ khóa
                  </NavLink>
                </NavItem>
              </Nav>
              <TabContent activeTab={tabVertical}>
                <TabPane tabId="1">
                  <GroupSetting />
                </TabPane>
                <TabPane tabId="2">
                  <PostSetting />
                </TabPane>
                <TabPane tabId="3">
                  <ProfileSetting />
                </TabPane>
                <TabPane tabId="4">
                  <FanpageSetting />
                </TabPane>
                <TabPane tabId="5">
                  <KeywordsSetting />
                </TabPane>
              </TabContent>
            </div>
          </ModalBody>
          <ModalFooter>
            <Button.Ripple
              type="button"
              className="btn"
              onClick={() => setModal(false)}
            >
              Đóng
            </Button.Ripple>
          </ModalFooter>
        </Modal>
      </div>

      {/* {/ menu khi thác khách hàng tiềm năng /} */}
      <CardBody className="pt-0">
        <Nav pills className="mt-3 d-block d-sm-flex ">
          {routers.map(item => (
            <NavItem key={item.id}>
              <NavLink
                active={active === item.id}
                onClick={() => {
                  toggle(item.id)
                  history.push(`/admin/exploit-potential-customers${item.path}`)
                }}
                className="justify-content-start w-sm-100"
              >
                {item.name}
              </NavLink>
            </NavItem>
          ))}
        </Nav>
        <TabContent className="py-50" activeTab={active}>
          <TabPane tabId="1">
            <ExploitedGroupPage />
          </TabPane>
          <TabPane tabId="2">
            <ExploitedPostPage />
          </TabPane>
          <TabPane tabId="3">
            <ExploitedFanpage />
          </TabPane>
          <TabPane tabId="4">
            <ExploitedProfile />
          </TabPane>
          <TabPane tabId="5">
            <ExploidtedKeyWords />
          </TabPane>
        </TabContent>
      </CardBody>
    </div>
  )
}

export default IndexExploited
